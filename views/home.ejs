<html>
    <head>
        <title>
            <%= title %>
        </title>
    </head>
    <body>
        <h1> coolzblog /  <%= title %> </h1>

        <section id="feed-posts">
            <h4>Posts </h4>
            <% if(locals.user){%> <!--this won't work as if user knows route 
                and object id then in inspect it can add form and make the post so, we add authentication
            on route side   passport.checkAuthentication which is define already-->
            <form action="/posts/create" id="new-post-form" method="POST">
                <textarea  name="content" cols="30" rows="3" placeholder="Type Here."></textarea>
              <input type="submit" value="Post">
            </form>
       <% }  %>

            <div id="posts-list-container">
                <ul>
                    <% for(post of posts){  %>

                        <li>
                            <p>
                               
                            <%    if(locals.user && locals.user.id===post.user.id){  %>
                                <small>
                                    <a href="/posts/destroy/<%= post.id %>">X</a>
                                </small>
                           <% }  %>
                                <%= post.content %>
                                <br>
                                <small>
                                    <%= post.user.name %>

                                </small>
                            </p>
                            <div class="post_comments">
                                <% if(locals.user){ %>
                                <form action="/comments/create" method="POST">
                                    <input type="text" name="content" placeholder="Type Here to add comment..">
                                    <input type="hidden" name="post" value="<%= post._id %>">
                                    <input type="submit" value="Add Comment">

                                </form>

                                <%} %>

                                <div class="post-comment-list">
                                    <ul id="post-comments-<%= post._id %>"> <!--to identify id later-->
                                       <% for(comment of post.comments){ %>
                                            <p>
                                                <%= comment.content %>
                                                <br>
                                                <small>
                                                    <%= comment.user.name  %>
                                                </small>
                                            </p>
                                    <%   } %>
                                    </ul>
                                </div>
                            </div>
                        </li>
                        
                        
                   <% } %>
                </ul>

            </div>
        </section>
    </body>
</html>


